'use client';

import { gsap } from 'gsap';
import { useEffect, useRef } from 'react';
import formCompleteStore from '../../../stores/formCompleteStore';

const Cone = ({ pathClassName, svgClassName, loader }) => {
  const { formSent, formCompleted } = formCompleteStore();
  const iconRef = useRef(null);

  useEffect(() => {
    const el = iconRef.current;
    if (el === null) return;
    if (loader && formSent) {
      gsap.to(el, {
        duration: 2,
        rotate: 360,
        ease: 'none',
        onComplete: () => {
          gsap.to(el, {
            rotate: 360,
          });
        },
      });
    }
  }, [formCompleted, formSent, loader]);
  return (
    <svg
      ref={iconRef}
      aria-label="Cone svg"
      viewBox="0 0 291 747"
      xmlns="http://www.w3.org/2000/svg"
      className={svgClassName}
    >
      <path
        className={`${pathClassName} transition-colors duration-500`}
        d="M272.559 247.234H264.923C252.782 248.151 241.126 252.385 231.23 259.474C230.23 260.338 228.954 260.818 227.636 260.823C225.975 260.838 224.402 260.094 223.365 258.802C222.381 257.693 221.881 256.229 221.99 254.75C222.094 253.271 222.792 251.896 223.928 250.937C236.152 241.927 250.766 236.735 265.933 236C268.251 235.88 270.579 235.88 272.897 236H279.412C290.553 220.031 293.355 199.688 286.938 181.303C280.209 164.683 266.542 151.833 249.537 146.152C252.98 141.079 255.948 135.704 258.407 130.089C271.188 98.9119 266.365 63.2826 245.756 36.6252C225.141 9.96924 191.876 -3.66676 158.485 0.854575C125.094 5.37591 96.6517 27.3652 83.8703 58.5426C82.7453 61.3499 81.7349 64.3811 80.8392 67.4175H92.8548C119.923 66.0842 145.855 78.3967 161.928 100.215C163.668 102.736 163.069 106.178 160.584 107.965C159.621 108.616 158.485 108.97 157.324 108.975C155.496 109.007 153.767 108.121 152.72 106.616C138.084 86.9493 114.376 76.1733 89.9385 78.0893L84.0947 78.7611H76.5739C45.3233 86.1882 19.6419 108.349 7.72462 138.177C0.557949 155.098 -1.68166 173.704 1.2558 191.844C4.19847 209.984 12.1985 226.926 24.3438 240.718C15.6771 249.661 11.5417 262.057 13.1146 274.412C17.1198 288.786 26.7546 300.938 39.844 308.109L147.104 734.003C148.823 741.091 155.192 746.065 162.489 746.018H165.411C172.036 745.982 177.718 741.289 178.999 734.789L275.478 289.456C283.056 286.148 288.488 279.284 289.967 271.149C290.05 262.482 286.795 254.113 280.868 247.785L272.559 247.234ZM116.225 247.234C118.022 247.234 160.365 249.703 171.485 212.193H171.48C172.35 209.089 175.569 207.276 178.673 208.146C181.772 209.016 183.584 212.234 182.714 215.333C170.246 255.541 128.464 258.464 117.908 258.464H115.439C113.954 258.381 112.574 257.698 111.6 256.579C110.626 255.459 110.147 253.99 110.272 252.511C110.293 251 110.955 249.563 112.085 248.563C113.215 247.558 114.72 247.073 116.225 247.234ZM166.767 733.661C166.563 734.437 165.881 734.984 165.079 735.01H162.157H162.162C160.475 734.968 159.011 733.828 158.569 732.203L54.5634 318.549L125.433 365.158L96.6834 396.273C94.3865 398.752 94.5375 402.622 97.0167 404.919C99.5011 407.216 103.371 407.065 105.668 404.58L198.886 303.498C206.834 294.951 217.25 289.091 228.684 286.738C240.117 284.384 252.001 285.649 262.684 290.358L166.767 733.661Z"
      />
    </svg>
  );
};

export default Cone;
